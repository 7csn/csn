<?php

// ----------------------------------------------------------------------
//  初始内存
// ----------------------------------------------------------------------

define('CSN_MEM_START', memory_get_usage());

// ----------------------------------------------------------------------
//  当前时间戳、初始时间
// ----------------------------------------------------------------------

define('CSN_TIME', $_SERVER['REQUEST_TIME']);
define('CSN_START', $_SERVER['REQUEST_TIME_FLOAT']);

// ----------------------------------------------------------------------
//  目录分隔符
// ----------------------------------------------------------------------

define('XG', DIRECTORY_SEPARATOR);

// ----------------------------------------------------------------------
//  框架相关目录：根目录、核心类库、配置文件、外调模型、辅助函数
// ----------------------------------------------------------------------

define('CSN', __DIR__ . XG);
define('CSN_T', CSN . 't' . XG);
define('CSN_S', CSN . 's' . XG);
define('CSN_Y', CSN . 'y' . XG);
define('CSN_X', CSN . 'x' . XG);

// ----------------------------------------------------------------------
//  项目根目录
// ----------------------------------------------------------------------

define('WEB', dirname(CSN) . XG);

// ----------------------------------------------------------------------
//  项目公共资源目录
// ----------------------------------------------------------------------

define('PUB', WEB . 'public' . XG);

// ----------------------------------------------------------------------
//  项目应用目录：根目录、模型、视图、控制器
// ----------------------------------------------------------------------

define('APP', WEB . 'application' . XG);
define('APP_MODEL', APP . 'models' . XG);
define('APP_VIEW', APP . 'views' . XG);
define('APP_CONTROLLER', APP . 'controllers' . XG);

// ----------------------------------------------------------------------
//  项目运行目录：根目录、会话、编译模板
// ----------------------------------------------------------------------

define('RUN', WEB . 'runtime' . XG);
define('RUN_S', RUN . 'session' . XG);
define('RUN_T', RUN . 'template' . XG);

// ----------------------------------------------------------------------
//  引入框架核心类文件
// ----------------------------------------------------------------------

include CSN_T . 'Csn.php';

// ----------------------------------------------------------------------
//  自加载composer类库
// ----------------------------------------------------------------------

\csn\Csn::need(WEB . 'vendor' . XG . 'autoload.php');

// ----------------------------------------------------------------------
//  自加载框架、项目类
// ----------------------------------------------------------------------

spl_autoload_register('\csn\Csn::load');

// ----------------------------------------------------------------------
//  自定义错误、异常
// ----------------------------------------------------------------------

set_error_handler('\csn\Exp::error');
set_exception_handler('\csn\Exp::exception');

// ----------------------------------------------------------------------
//  框架初始化
// ----------------------------------------------------------------------

\csn\Csn::init();