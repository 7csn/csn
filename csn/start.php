<?php

// ----------------------------------------------------------------------
//  初始内存
// ----------------------------------------------------------------------

define('CSN_MEM_START', memory_get_usage());

// ----------------------------------------------------------------------
//  当前时间戳、初始时间
// ----------------------------------------------------------------------

define('CSN_TIME', $_SERVER['REQUEST_TIME']);
define('CSN_START', $_SERVER['REQUEST_TIME_FLOAT']);

// ----------------------------------------------------------------------
//  目录分隔符
// ----------------------------------------------------------------------

define('DS', DIRECTORY_SEPARATOR);

// ----------------------------------------------------------------------
//  框架相关目录：根目录、核心类库、配置文件、外调模型、辅助函数
// ----------------------------------------------------------------------

define('CSN', __DIR__ . DS);
define('CSN_T', CSN . 't' . DS);
define('CSN_S', CSN . 's' . DS);
define('CSN_Y', CSN . 'y' . DS);
define('CSN_X', CSN . 'x' . DS);

// ----------------------------------------------------------------------
//  项目根目录
// ----------------------------------------------------------------------

define('WEB', dirname(CSN) . DS);

// ----------------------------------------------------------------------
//  项目公共资源目录
// ----------------------------------------------------------------------

define('PUB', WEB . 'public' . DS);

// ----------------------------------------------------------------------
//  项目应用目录：根目录、模型、视图、控制器、配置、会话(存文件有效)
// ----------------------------------------------------------------------

define('APP', WEB . 'application' . DS);
define('APP_MODEL', APP . 'models' . DS);
define('APP_VIEW', APP . 'views' . DS);
define('APP_CONTROLLER', APP . 'controllers' . DS);
define('APP_CONFIG', APP . 'configs' . DS);
define('APP_SESSION', APP . 'session' . DS);

// ----------------------------------------------------------------------
//  项目运行目录
// ----------------------------------------------------------------------

define('RUN', WEB . 'runtime' . DS);

// ----------------------------------------------------------------------
//  项目编译目录：PHP、HTML
// ----------------------------------------------------------------------

define('WEB_COMPILE', WEB . 'compile' . DS);
define('WEB_STATIC', WEB . 'static' . DS);

// ----------------------------------------------------------------------
//  换行
// ----------------------------------------------------------------------

define('ENTER', PHP_EOL);

// ----------------------------------------------------------------------
//  引入框架核心类文件
// ----------------------------------------------------------------------

include CSN_T . 'Csn.php';

// ----------------------------------------------------------------------
//  自加载composer类库
// ----------------------------------------------------------------------

\csn\Csn::need(WEB . 'vendor' . DS . 'autoload.php');

// ----------------------------------------------------------------------
//  自加载模型：框架核心、框架外调、项目
// ----------------------------------------------------------------------

spl_autoload_register('\csn\Csn::load');

// ----------------------------------------------------------------------
//  自定义错误异常：关闭错误输出、错误、致命错误、异常
// ----------------------------------------------------------------------

ini_set('display_errors', 'Off');
set_error_handler('\csn\Csn::error');
register_shutdown_function('\csn\Csn::fatal');
set_exception_handler('\csn\Csn::exception');

// ----------------------------------------------------------------------
//  框架初始化
// ----------------------------------------------------------------------

\csn\Csn::init();