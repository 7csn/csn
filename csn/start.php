<?php

// ----------------------------------------------------------------------
//  初始内存
// ----------------------------------------------------------------------

define('CSN_MEM_START', memory_get_usage());

// ----------------------------------------------------------------------
//  当前时间戳、初始时间
// ----------------------------------------------------------------------

define('CSN_TIME', $_SERVER['REQUEST_TIME']);
define('CSN_START', $_SERVER['REQUEST_TIME_FLOAT']);

// ----------------------------------------------------------------------
//  目录分隔符
// ----------------------------------------------------------------------

define('DS', DIRECTORY_SEPARATOR);

// ----------------------------------------------------------------------
//  框架相关目录：根目录、核心类库、配置文件、外调模型、辅助函数
// ----------------------------------------------------------------------

define('CSN', __DIR__ . DS);
define('CSN_T', CSN . 't' . DS);
define('CSN_S', CSN . 's' . DS);
define('CSN_Y', CSN . 'y' . DS);
define('CSN_X', CSN . 'x' . DS);

// ----------------------------------------------------------------------
//  项目根目录
// ----------------------------------------------------------------------

define('WEB', dirname(CSN) . DS);

// ----------------------------------------------------------------------
//  项目公共资源目录
// ----------------------------------------------------------------------

define('PUB', WEB . 'public' . DS);

// ----------------------------------------------------------------------
//  项目应用目录：根目录、模型、视图、控制器、配置
// ----------------------------------------------------------------------

define('APP', WEB . 'application' . DS);
define('APP_MODEL', APP . 'models' . DS);
define('APP_VIEW', APP . 'views' . DS);
define('APP_CONTROLLER', APP . 'controllers' . DS);
define('APP_CONFIG', APP . 'configs' . DS);

// ----------------------------------------------------------------------
//  项目运行目录：根目录、会话、访问、异常、SQL、编译PHP、编译HTML
// ----------------------------------------------------------------------

define('RUN', WEB . 'runtime' . DS);
define('RUN_SESSION', RUN . 'session' . DS);
define('RUN_ACTION', RUN . 'action' . DS);
define('RUN_ERROR', RUN . 'error' . DS);
define('RUN_SQL', RUN . 'sql' . DS);
define('RUN_PHP', RUN . 'php' . DS);
define('RUN_HTML', RUN . 'html' . DS);

// ----------------------------------------------------------------------
//  引入框架核心类文件
// ----------------------------------------------------------------------

include CSN_T . 'Csn.php';

// ----------------------------------------------------------------------
//  自加载composer类库
// ----------------------------------------------------------------------

\csn\Csn::need(WEB . 'vendor' . DS . 'autoload.php');

// ----------------------------------------------------------------------
//  自加载模型：框架核心、框架外调、项目
// ----------------------------------------------------------------------

spl_autoload_register('\csn\Csn::load');

// ----------------------------------------------------------------------
//  自定义错误、异常
// ----------------------------------------------------------------------

set_error_handler('\csn\Csn::error');
set_exception_handler('\csn\Csn::exception');

// ----------------------------------------------------------------------
//  框架初始化
// ----------------------------------------------------------------------

\csn\Csn::init();